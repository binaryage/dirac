{"version":3,"file":"acorn-numeric-separator.mjs","sources":["../src/index.js"],"sourcesContent":["function withoutAcornBigInt(acorn, Parser) {\n  return class extends Parser {\n    readInt(radix, len) {\n      // Hack: len is only != null for unicode escape sequences,\n      // where numeric separators are not allowed\n      if (len != null) return super.readInt(radix, len)\n\n      let start = this.pos, total = 0, acceptUnderscore = false\n      for (;;) {\n        let code = this.input.charCodeAt(this.pos), val\n        if (code >= 97) val = code - 97 + 10 // a\n        else if (code == 95) {\n          if (!acceptUnderscore) this.raise(this.pos, \"Invalid numeric separator\")\n          ++this.pos\n          acceptUnderscore = false\n          continue\n        } else if (code >= 65) val = code - 65 + 10 // A\n        else if (code >= 48 && code <= 57) val = code - 48 // 0-9\n        else val = Infinity\n        if (val >= radix) break\n        ++this.pos\n        total = total * radix + val\n        acceptUnderscore = true\n      }\n      if (this.pos === start) return null\n      if (!acceptUnderscore) this.raise(this.pos - 1, \"Invalid numeric separator\")\n\n      return total\n    }\n\n    readNumber(startsWithDot) {\n      const token = super.readNumber(startsWithDot)\n      let octal = this.end - this.start >= 2 && this.input.charCodeAt(this.start) === 48\n      const stripped = this.getNumberInput(this.start, this.end)\n      if (stripped.length < this.end - this.start) {\n        if (octal) this.raise(this.start, \"Invalid number\")\n        this.value = parseFloat(stripped)\n      }\n      return token\n    }\n\n    // This is used by acorn-bigint\n    getNumberInput(start, end) {\n      return this.input.slice(start, end).replace(/_/g, \"\")\n    }\n  }\n}\n\nfunction withAcornBigInt(acorn, Parser) {\n  return class extends Parser {\n    readInt(radix, len) {\n      // Hack: len is only != null for unicode escape sequences,\n      // where numeric separators are not allowed\n      if (len != null) return super.readInt(radix, len)\n\n      let start = this.pos, total = 0, acceptUnderscore = false\n      for (;;) {\n        let code = this.input.charCodeAt(this.pos), val\n        if (code >= 97) val = code - 97 + 10 // a\n        else if (code == 95) {\n          if (!acceptUnderscore) this.raise(this.pos, \"Invalid numeric separator\")\n          ++this.pos\n          acceptUnderscore = false\n          continue\n        } else if (code >= 65) val = code - 65 + 10 // A\n        else if (code >= 48 && code <= 57) val = code - 48 // 0-9\n        else val = Infinity\n        if (val >= radix) break\n        ++this.pos\n        total = total * radix + val\n        acceptUnderscore = true\n      }\n      if (this.pos === start) return null\n      if (!acceptUnderscore) this.raise(this.pos - 1, \"Invalid numeric separator\")\n\n      return total\n    }\n\n    readNumber(startsWithDot) {\n      let start = this.pos\n      if (!startsWithDot && this.readInt(10) === null) this.raise(start, \"Invalid number\")\n      let octal = this.pos - start >= 2 && this.input.charCodeAt(start) === 48\n      let octalLike = false\n      if (octal && this.strict) this.raise(start, \"Invalid number\")\n      let next = this.input.charCodeAt(this.pos)\n      if (!octal && !startsWithDot && this.options.ecmaVersion >= 11 && next === 110) {\n        let str = this.getNumberInput(start, this.pos)\n        // eslint-disable-next-line node/no-unsupported-features/es-builtins\n        let val = typeof BigInt !== \"undefined\" ? BigInt(str) : null\n        ++this.pos\n        if (acorn.isIdentifierStart(this.fullCharCodeAtPos())) this.raise(this.pos, \"Identifier directly after number\")\n        return this.finishToken(acorn.tokTypes.num, val)\n      }\n      if (octal && /[89]/.test(this.input.slice(start, this.pos))) {\n        octal = false\n        octalLike = true\n      }\n      if (next === 46 && !octal) { // '.'\n        ++this.pos\n        this.readInt(10)\n        next = this.input.charCodeAt(this.pos)\n      }\n      if ((next === 69 || next === 101) && !octal) { // 'eE'\n        next = this.input.charCodeAt(++this.pos)\n        if (next === 43 || next === 45) ++this.pos // '+-'\n        if (this.readInt(10) === null) this.raise(start, \"Invalid number\")\n      }\n      if (acorn.isIdentifierStart(this.fullCharCodeAtPos())) this.raise(this.pos, \"Identifier directly after number\")\n      let str = this.getNumberInput(start, this.pos)\n      if ((octal || octalLike) && str.length < this.pos - start) {\n        this.raise(start, \"Invalid number\")\n      }\n\n      let val = octal ? parseInt(str, 8) : parseFloat(str)\n      return this.finishToken(acorn.tokTypes.num, val)\n    }\n\n    parseLiteral(value) {\n      const ret = super.parseLiteral(value)\n      if (ret.bigint) ret.bigint = ret.bigint.replace(/_/g, \"\")\n      return ret\n    }\n\n    readRadixNumber(radix) {\n      let start = this.pos\n      this.pos += 2 // 0x\n      let val = this.readInt(radix)\n      if (val == null) { this.raise(this.start + 2, `Expected number in radix ${radix}`) }\n      if (this.options.ecmaVersion >= 11 && this.input.charCodeAt(this.pos) === 110) {\n        let str = this.getNumberInput(start, this.pos)\n        // eslint-disable-next-line node/no-unsupported-features/es-builtins\n        val = typeof BigInt !== \"undefined\" ? BigInt(str) : null\n        ++this.pos\n      } else if (acorn.isIdentifierStart(this.fullCharCodeAtPos())) { this.raise(this.pos, \"Identifier directly after number\") }\n      return this.finishToken(acorn.tokTypes.num, val)\n    }\n\n    // This is used by acorn-bigint, which theoretically could be used with acorn@6.2 || acorn@7\n    getNumberInput(start, end) {\n      return this.input.slice(start, end).replace(/_/g, \"\")\n    }\n  }\n}\n\n// eslint-disable-next-line node/no-unsupported-features/es-syntax\nexport default function numericSeparator(Parser) {\n  const acorn = Parser.acorn || require(\"acorn\")\n  const withAcornBigIntSupport = (acorn.version.startsWith(\"6.\") && !(acorn.version.startsWith(\"6.0.\") || acorn.version.startsWith(\"6.1.\"))) || acorn.version.startsWith(\"7.\")\n\n  return withAcornBigIntSupport ? withAcornBigInt(acorn, Parser) : withoutAcornBigInt(acorn, Parser)\n}\n"],"names":[],"mappings":"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"}